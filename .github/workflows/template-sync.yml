# 定期从上游模板仓库同步更新
name: Sync from template

on:
  schedule:
    - cron: "0 3 * * 1"  # 每周一（UTC）
  workflow_dispatch:      # 允许手动触发

jobs:
  repo-sync:
    runs-on: ubuntu-latest
    permissions:
      contents: write       # 需要写权限以推送到分支
      pull-requests: write  # 需要权限以创建 PR

    steps:
      - name: Checkout
        uses: actions/checkout@v6
        with:
          fetch-depth: 0
          persist-credentials: false

      - name: Sync template
        uses: AndreasAugustin/actions-template-sync@v2
        with:
          target_gh_token: ${{ secrets.TEMPLATE_SYNC_PAT }}
          source_repo_path: Misty02600/nonebot-plugin-template
          upstream_branch: main
          pr_labels: template_sync
          git_remote_pull_params: "--allow-unrelated-histories --squash"
